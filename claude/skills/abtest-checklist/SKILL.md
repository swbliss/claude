---
name: abtest-checklist
description: 사용자가 지정한 여러 인스턴스의 특정 경로에 접속하여, ab test를 실행하기 전 코드 버전과 설정 파일의 내용을 비교합니다.
disable-model-invocation: true
allowed-tools: Bash(*)
---

## 실행 트리거
- "[호스트A:경로A], [호스트B:경로B] 비교해줘"
- "인스턴스 정합성 체크: [리스트]"
- "서로 다른 경로에 있는 인스턴스들 비교: [리스트]"

## 실행 지침 (Step-by-Step)

1. **인자 분석 및 파싱**:
   - 사용자가 입력한 메시지에서 `호스트:경로` 형태의 쌍을 모두 추출한다.
   - 만약 사용자가 경로를 생략하고 호스트 이름만 적었다면, 기본 경로(예: `~/heosubun-v2/v4`)를 사용하거나 필요시 사용자에게 확인한다.

2. **데이터 수집 (반복 실행)**:
   - 파싱된 각 **[호스트]**와 **[경로]** 조합에 대해 다음 명령어를 실행한다. (**[호스트]**는 사용자가 ssh 접근을 위해 서버별로 설정해둔 alias이므로 앞에 ssh 없이 호출해야 instance에 접근 가능하다.)
   - 명령어: `[호스트] "cd [경로] && echo '---HASH---' && git rev-parse HEAD && echo '---STATUS---' && git status --short && echo '---CONFIG---' && cat config.yml"`

3. **비교 및 분석**:
   - **Git Hash**: 각 경로의 최신 커밋 해시가 모두 일치하는지 대조한다.
   - **Git Status**: 각 인스턴스 경로 내에 커밋되지 않은 수정 사항이 있는지 확인하고 인스턴스간에 차이가 있는 수정 사항이 어떤 내용인지 파악하여 간단하게 요약한다.
   - **Config**: 수집된 `config.yml` 내용들 사이의 차이점(diff)을 분석한다.

4. **결과 보고**:
   - 각 인스턴스와 해당 경로를 명시하여 비교 결과를 **표(Table)** 형식으로 정리한다.
   - 불일치하는 항목이 있다면 강조하여 표시하고, 설정값의 차이가 운영에 미칠 수 있는 영향을 요약하여 보고한다.
